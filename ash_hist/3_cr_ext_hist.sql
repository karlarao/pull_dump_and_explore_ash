drop table dump_dba_hist_ash_ext purge; 

-- the external table
        -- CREATE DIRECTORY statements needed for files
        ------------------------------------------------------------------------
CREATE OR REPLACE DIRECTORY SYS_SQLLDR_XT_TMPDIR_00002 AS '/home/oracle/tmp3/pull_dump_and_explore_ash-master/ash_hist/';
CREATE OR REPLACE DIRECTORY SYS_SQLLDR_XT_TMPDIR_00000 AS '/home/oracle/tmp3/pull_dump_and_explore_ash-master/ash_hist/';


        -- CREATE TABLE statement for external table:
        ------------------------------------------------------------------------
CREATE TABLE dump_dba_hist_ash_ext
(
  "INSTNAME" CHAR(255),
  "INSTANCE_NUMBER" CHAR(255),
  "DBID" CHAR(255),
  "SNAP_ID" CHAR(255),
  "SAMPLE_ID" CHAR(255),
  "TM" TIMESTAMP(3),
  "TMS" TIMESTAMP(3),
  "SAMPLE_TIME" CHAR(255),
  "SESSION_ID" CHAR(255),
  "SESSION_SERIAL#" CHAR(255),
  "SESSION_TYPE" CHAR(255),
  "FLAGS" CHAR(255),
  "USER_ID" CHAR(255),
  "SQL_ID" CHAR(255),
  "IS_SQLID_CURRENT" CHAR(255),
  "SQL_CHILD_NUMBER" CHAR(255),
  "SQL_OPCODE" CHAR(255),
  "SQL_OPNAME" CHAR(255),
  "FORCE_MATCHING_SIGNATURE" CHAR(255),
  "TOP_LEVEL_SQL_ID" CHAR(255),
  "TOP_LEVEL_SQL_OPCODE" CHAR(255),
  "SQL_PLAN_HASH_VALUE" CHAR(255),
  "SQL_PLAN_LINE_ID" CHAR(255),
  "SQL_PLAN_OPERATION" CHAR(255),
  "SQL_PLAN_OPTIONS" CHAR(255),
  "SQL_EXEC_ID" CHAR(255),
  "SQL_EXEC_START" CHAR(255),
  "PLSQL_ENTRY_OBJECT_ID" CHAR(255),
  "PLSQL_ENTRY_SUBPROGRAM_ID" CHAR(255),
  "PLSQL_OBJECT_ID" CHAR(255),
  "PLSQL_SUBPROGRAM_ID" CHAR(255),
  "QC_INSTANCE_ID" CHAR(255),
  "QC_SESSION_ID" CHAR(255),
  "QC_SESSION_SERIAL#" CHAR(255),
  "PX_FLAGS" CHAR(255),
  "EVENT" CHAR(255),
  "EVENT_ID" CHAR(255),
  "SEQ#" CHAR(255),
  "P1TEXT" CHAR(255),
  "P1" CHAR(255),
  "P2TEXT" CHAR(255),
  "P2" CHAR(255),
  "P3TEXT" CHAR(255),
  "P3" CHAR(255),
  "WAIT_CLASS" CHAR(255),
  "WAIT_CLASS_ID" CHAR(255),
  "WAIT_TIME" CHAR(255),
  "SESSION_STATE" CHAR(255),
  "TIME_WAITED" CHAR(255),
  "BLOCKING_SESSION_STATUS" CHAR(255),
  "BLOCKING_SESSION" CHAR(255),
  "BLOCKING_SESSION_SERIAL#" CHAR(255),
  "BLOCKING_INST_ID" CHAR(255),
  "BLOCKING_HANGCHAIN_INFO" CHAR(255),
  "CURRENT_OBJ#" CHAR(255),
  "CURRENT_FILE#" CHAR(255),
  "CURRENT_BLOCK#" CHAR(255),
  "CURRENT_ROW#" CHAR(255),
  "TOP_LEVEL_CALL#" CHAR(255),
  "TOP_LEVEL_CALL_NAME" CHAR(255),
  "CONSUMER_GROUP_ID" CHAR(255),
  "XID" CHAR(255),
  "REMOTE_INSTANCE#" CHAR(255),
  "TIME_MODEL" CHAR(255),
  "IN_CONNECTION_MGMT" CHAR(255),
  "IN_PARSE" CHAR(255),
  "IN_HARD_PARSE" CHAR(255),
  "IN_SQL_EXECUTION" CHAR(255),
  "IN_PLSQL_EXECUTION" CHAR(255),
  "IN_PLSQL_RPC" CHAR(255),
  "IN_PLSQL_COMPILATION" CHAR(255),
  "IN_JAVA_EXECUTION" CHAR(255),
  "IN_BIND" CHAR(255),
  "IN_CURSOR_CLOSE" CHAR(255),
  "IN_SEQUENCE_LOAD" CHAR(255),
  "CAPTURE_OVERHEAD" CHAR(255),
  "REPLAY_OVERHEAD" CHAR(255),
  "IS_CAPTURED" CHAR(255),
  "IS_REPLAYED" CHAR(255),
  "SERVICE_HASH" CHAR(255),
  "PROGRAM" CHAR(255),
  "MODULE" CHAR(255),
  "ACTION" CHAR(255),
  "CLIENT_ID" CHAR(255),
  "MACHINE" CHAR(255),
  "PORT" CHAR(255),
  "ECID" CHAR(255),
  "DBREPLAY_FILE_ID" CHAR(255),
  "DBREPLAY_CALL_COUNTER" CHAR(255),
  "TM_DELTA_TIME" CHAR(255),
  "TM_DELTA_CPU_TIME" CHAR(255),
  "TM_DELTA_DB_TIME" CHAR(255),
  "DELTA_TIME" CHAR(255),
  "DELTA_READ_IO_REQUESTS" CHAR(255),
  "DELTA_WRITE_IO_REQUESTS" CHAR(255),
  "DELTA_READ_IO_BYTES" CHAR(255),
  "DELTA_WRITE_IO_BYTES" CHAR(255),
  "DELTA_INTERCONNECT_IO_BYTES" CHAR(255),
  "PGA_ALLOCATED" CHAR(255),
  "TEMP_SPACE_ALLOCATED" CHAR(255)
)
ORGANIZATION external
(
  TYPE oracle_loader
  DEFAULT DIRECTORY SYS_SQLLDR_XT_TMPDIR_00000
  ACCESS PARAMETERS
  (
    RECORDS DELIMITED BY NEWLINE CHARACTERSET US7ASCII
    BADFILE 'SYS_SQLLDR_XT_TMPDIR_00000':'myash_1129.bad'
    DISCARDFILE 'SYS_SQLLDR_XT_TMPDIR_00000':'myash_1129.discard'
    LOGFILE 'SYS_SQLLDR_XT_TMPDIR_00002':'2_gen_ext.log_xt'
    READSIZE 1048576
    FIELDS TERMINATED BY "," LDRTRIM
    MISSING FIELD VALUES ARE NULL
    REJECT ROWS WITH ALL NULL FIELDS
    (
      "INSTNAME" CHAR(255)
        TERMINATED BY ",",
      "INSTANCE_NUMBER" CHAR(255)
        TERMINATED BY ",",
      "DBID" CHAR(255)
        TERMINATED BY ",",
      "SNAP_ID" CHAR(255)
        TERMINATED BY ",",
      "SAMPLE_ID" CHAR(255)
        TERMINATED BY ",",
      "TM" CHAR(255)
        TERMINATED BY ","
        DATE_FORMAT DATE MASK "MM/DD/YY HH24:MI:SS",
      "TMS" CHAR(255)
        TERMINATED BY ","
        DATE_FORMAT DATE MASK "MM/DD/YY HH24:MI:SS",        
      "SAMPLE_TIME" CHAR(255)
        TERMINATED BY ",",
      "SESSION_ID" CHAR(255)
        TERMINATED BY ",",
      "SESSION_SERIAL#" CHAR(255)
        TERMINATED BY ",",
      "SESSION_TYPE" CHAR(255)
        TERMINATED BY ",",
      "FLAGS" CHAR(255)
        TERMINATED BY ",",
      "USER_ID" CHAR(255)
        TERMINATED BY ",",
      "SQL_ID" CHAR(255)
        TERMINATED BY ",",
      "IS_SQLID_CURRENT" CHAR(255)
        TERMINATED BY ",",
      "SQL_CHILD_NUMBER" CHAR(255)
        TERMINATED BY ",",
      "SQL_OPCODE" CHAR(255)
        TERMINATED BY ",",
      "SQL_OPNAME" CHAR(255)
        TERMINATED BY ",",
      "FORCE_MATCHING_SIGNATURE" CHAR(255)
        TERMINATED BY ",",
      "TOP_LEVEL_SQL_ID" CHAR(255)
        TERMINATED BY ",",
      "TOP_LEVEL_SQL_OPCODE" CHAR(255)
        TERMINATED BY ",",
      "SQL_PLAN_HASH_VALUE" CHAR(255)
        TERMINATED BY ",",
      "SQL_PLAN_LINE_ID" CHAR(255)
        TERMINATED BY ",",
      "SQL_PLAN_OPERATION" CHAR(255)
        TERMINATED BY ",",
      "SQL_PLAN_OPTIONS" CHAR(255)
        TERMINATED BY ",",
      "SQL_EXEC_ID" CHAR(255)
        TERMINATED BY ",",
      "SQL_EXEC_START" CHAR(255)
        TERMINATED BY ",",
      "PLSQL_ENTRY_OBJECT_ID" CHAR(255)
        TERMINATED BY ",",
      "PLSQL_ENTRY_SUBPROGRAM_ID" CHAR(255)
        TERMINATED BY ",",
      "PLSQL_OBJECT_ID" CHAR(255)
        TERMINATED BY ",",
      "PLSQL_SUBPROGRAM_ID" CHAR(255)
        TERMINATED BY ",",
      "QC_INSTANCE_ID" CHAR(255)
        TERMINATED BY ",",
      "QC_SESSION_ID" CHAR(255)
        TERMINATED BY ",",
      "QC_SESSION_SERIAL#" CHAR(255)
        TERMINATED BY ",",
      "PX_FLAGS" CHAR(255)
        TERMINATED BY ",",
      "EVENT" CHAR(255)
        TERMINATED BY ",",
      "EVENT_ID" CHAR(255)
        TERMINATED BY ",",
      "SEQ#" CHAR(255)
        TERMINATED BY ",",
      "P1TEXT" CHAR(255)
        TERMINATED BY ",",
      "P1" CHAR(255)
        TERMINATED BY ",",
      "P2TEXT" CHAR(255)
        TERMINATED BY ",",
      "P2" CHAR(255)
        TERMINATED BY ",",
      "P3TEXT" CHAR(255)
        TERMINATED BY ",",
      "P3" CHAR(255)
        TERMINATED BY ",",
      "WAIT_CLASS" CHAR(255)
        TERMINATED BY ",",
      "WAIT_CLASS_ID" CHAR(255)
        TERMINATED BY ",",
      "WAIT_TIME" CHAR(255)
        TERMINATED BY ",",
      "SESSION_STATE" CHAR(255)
        TERMINATED BY ",",
      "TIME_WAITED" CHAR(255)
        TERMINATED BY ",",
      "BLOCKING_SESSION_STATUS" CHAR(255)
        TERMINATED BY ",",
      "BLOCKING_SESSION" CHAR(255)
        TERMINATED BY ",",
      "BLOCKING_SESSION_SERIAL#" CHAR(255)
        TERMINATED BY ",",
      "BLOCKING_INST_ID" CHAR(255)
        TERMINATED BY ",",
      "BLOCKING_HANGCHAIN_INFO" CHAR(255)
        TERMINATED BY ",",
      "CURRENT_OBJ#" CHAR(255)
        TERMINATED BY ",",
      "CURRENT_FILE#" CHAR(255)
        TERMINATED BY ",",
      "CURRENT_BLOCK#" CHAR(255)
        TERMINATED BY ",",
      "CURRENT_ROW#" CHAR(255)
        TERMINATED BY ",",
      "TOP_LEVEL_CALL#" CHAR(255)
        TERMINATED BY ",",
      "TOP_LEVEL_CALL_NAME" CHAR(255)
        TERMINATED BY ",",
      "CONSUMER_GROUP_ID" CHAR(255)
        TERMINATED BY ",",
      "XID" CHAR(255)
        TERMINATED BY ",",
      "REMOTE_INSTANCE#" CHAR(255)
        TERMINATED BY ",",
      "TIME_MODEL" CHAR(255)
        TERMINATED BY ",",
      "IN_CONNECTION_MGMT" CHAR(255)
        TERMINATED BY ",",
      "IN_PARSE" CHAR(255)
        TERMINATED BY ",",
      "IN_HARD_PARSE" CHAR(255)
        TERMINATED BY ",",
      "IN_SQL_EXECUTION" CHAR(255)
        TERMINATED BY ",",
      "IN_PLSQL_EXECUTION" CHAR(255)
        TERMINATED BY ",",
      "IN_PLSQL_RPC" CHAR(255)
        TERMINATED BY ",",
      "IN_PLSQL_COMPILATION" CHAR(255)
        TERMINATED BY ",",
      "IN_JAVA_EXECUTION" CHAR(255)
        TERMINATED BY ",",
      "IN_BIND" CHAR(255)
        TERMINATED BY ",",
      "IN_CURSOR_CLOSE" CHAR(255)
        TERMINATED BY ",",
      "IN_SEQUENCE_LOAD" CHAR(255)
        TERMINATED BY ",",
      "CAPTURE_OVERHEAD" CHAR(255)
        TERMINATED BY ",",
      "REPLAY_OVERHEAD" CHAR(255)
        TERMINATED BY ",",
      "IS_CAPTURED" CHAR(255)
        TERMINATED BY ",",
      "IS_REPLAYED" CHAR(255)
        TERMINATED BY ",",
      "SERVICE_HASH" CHAR(255)
        TERMINATED BY ",",
      "PROGRAM" CHAR(255)
        TERMINATED BY ",",
      "MODULE" CHAR(255)
        TERMINATED BY ",",
      "ACTION" CHAR(255)
        TERMINATED BY ",",
      "CLIENT_ID" CHAR(255)
        TERMINATED BY ",",
      "MACHINE" CHAR(255)
        TERMINATED BY ",",
      "PORT" CHAR(255)
        TERMINATED BY ",",
      "ECID" CHAR(255)
        TERMINATED BY ",",
      "DBREPLAY_FILE_ID" CHAR(255)
        TERMINATED BY ",",
      "DBREPLAY_CALL_COUNTER" CHAR(255)
        TERMINATED BY ",",
      "TM_DELTA_TIME" CHAR(255)
        TERMINATED BY ",",
      "TM_DELTA_CPU_TIME" CHAR(255)
        TERMINATED BY ",",
      "TM_DELTA_DB_TIME" CHAR(255)
        TERMINATED BY ",",
      "DELTA_TIME" CHAR(255)
        TERMINATED BY ",",
      "DELTA_READ_IO_REQUESTS" CHAR(255)
        TERMINATED BY ",",
      "DELTA_WRITE_IO_REQUESTS" CHAR(255)
        TERMINATED BY ",",
      "DELTA_READ_IO_BYTES" CHAR(255)
        TERMINATED BY ",",
      "DELTA_WRITE_IO_BYTES" CHAR(255)
        TERMINATED BY ",",
      "DELTA_INTERCONNECT_IO_BYTES" CHAR(255)
        TERMINATED BY ",",
      "PGA_ALLOCATED" CHAR(255)
        TERMINATED BY ",",
      "TEMP_SPACE_ALLOCATED" CHAR(255)
        TERMINATED BY ","
    )
  )
  location
  (
    'myash.csv'
  )
)REJECT LIMIT UNLIMITED
/

